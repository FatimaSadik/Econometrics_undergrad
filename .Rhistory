install.packages(systemfit)
install.packages("systemfit")
install.packages(PoEdata)
install.packages("remotes")
remotes::install_github("ccolonescu/PoEdata")
library(systemfit)
library(PoEdata)
data("truffles")
View(truffles)
View(truffles)
#reduced form equations
rf_p<-lm(p~ps+di+pf,data=truffles)
rf_q<-lm(q~ps+di+pf,data=truffles)
summary(rf_p)
summary(rf_q)
truffles$p_hat<-fitted.values$rf_p
truffles$p_hat<-fitted.values(rf_p)
truffles$q_hat<-fitted.values(rf_q)
#2nd stage
seq_1<-lm(q_hat~p_hat+ps+di,data=truffles)
summary(seq_1)
#2nd stage
seq_1<-lm(q~p_hat+ps+di,data=truffles)
summary(seq_1)
seq_2<-lm(q_hat~p+pf,data=truffles)
summary(seq_2)
seq_2<-lm(q~p_hat+pf,data=truffles)
summary(seq_2)
D <- q~p+ps+di
S <- q~p+pf
sys <- list(D,S)
View(sys)
instr <- ~ps+di+pf
truff.sys <- systemfit(sys, inst=instr,
method="2SLS", data=truffles)
summary(truff.sys)
